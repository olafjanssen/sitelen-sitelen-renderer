# Sitelen Sitelen Renderer

A modern Rust-based renderer for converting Toki Pona text into the Sitelen Sitelen or Sitelen Suwi non-linear writing style. This is a complete rewrite of the original JavaScript implementation, providing better performance, type safety, and a cleaner API while maintaining the same visual output and spirit of the original project.

## Motivation

I created Sitelen Sitelen Renderer because I am fascinated by combining the artificial language Toki Pona with the non-linear writing style 'Sitelen Sitelen' by Jonathan Gabel. Unlike other work with Sitelen Sitelen, I want the writings to be generated by the computer. My [first attempt](http://nullelement.org/2015/05/living-toki-pona-using-flexbox-layout-and-sitelen-sitelen/) was in the beginning of 2015 when I experimented with CSS Flexbox using SVG for the Glyphs. The algorithm was limited and doomed, so in October 2015 I started anew and set out to create SVG-only sitelen sitelen that can be exported and reused.

This Rust rewrite maintains the same visual output and algorithm spirit while providing better performance, type safety, and modern tooling. This is still a hobby project that I work on in my spare time.

## Features

- **CLI-first**: Native command-line tool for rendering Toki Pona text
- **Multiple output formats**: SVG, PNG, and HTML
- **WASM support**: Browser-compatible WebAssembly build for web integration
- **Type-safe**: Built with Rust for compile-time guarantees
- **High performance**: Significantly faster than the JavaScript version
- **Same visual output**: Maintains compatibility with the original JavaScript implementation

## Installation

### CLI

```bash
cargo install --path sitelen-cli
```

Or build from source:

```bash
git clone https://github.com/olafjanssen/sitelen-sitelen-renderer.git
cd sitelen-sitelen-renderer
cargo build --release
```

### WASM

Build the WASM package:

```bash
cd sitelen-wasm
wasm-pack build --target web --out-dir pkg
```

## Usage

### CLI

```bash
# Render text directly
sitelen "mi pona. ale li jo e tenpo." --output output.svg

# Render from file
sitelen --input text.txt --output output.png --format png

# With custom settings
sitelen --input text.txt --output output.svg --ratio 0.8 --stroke-width 2.0 --shadow
```

### Library (Rust)

```rust
use sitelen_core::{OutputFormat, Pipeline};

let pipeline = Pipeline::new()?;
let svg_bytes = pipeline.render_text("mi pona.", OutputFormat::Svg)?;
std::fs::write("output.svg", svg_bytes)?;
```

### WASM (JavaScript)

```javascript
import init, { render_svg } from './pkg/sitelen_wasm.js';

await init();
const svgString = render_svg("mi pona.", null);
document.body.innerHTML = svgString;
```

For auto-rendering elements with the `data-sitelen` attribute:

```javascript
import './pkg/auto.js';
```

Then in your HTML:

```html
<section data-sitelen>
    ale li jo e tenpo. ale li pona.
</section>
```

## Examples

The project includes several example pages demonstrating different use cases:

- **Layout engine** (`examples/layout/layout.html`): Optimally fills a page with Sitelen Sitelen by trying different layout ratios (experimental)
- **Tatoeba corpus** (`examples/tatoeba/tatoeba.html`): Displays sentences from the Tatoeba corpus
- **Tatoeba book** (`examples/tatoeba/tatoeba-book.html`): Generates a book-like layout of Tatoeba sentences
- **Glyph explorer** (`examples/interface/glyphexplorer.html`): Interactive exploration of all available glyphs
- **Proverbs** (`examples/proverbs/proverbs.html`): Overview of Toki Pona proverbs from Sonja's book
- **Live input** (`examples/liveinput/liveinput.html`): Interactive input with live preview
- **Interface** (`examples/interface/interface.html`): Sandbox for testing rendering

## Architecture

The project is organized as a Rust workspace with three main crates:

- **`sitelen-core`**: Core library with parsing, layout, and rendering logic
- **`sitelen-cli`**: Command-line interface
- **`sitelen-wasm`**: WebAssembly bindings for browser use

## Development

### Building

```bash
# Build all crates
cargo build

# Build specific crate
cargo build -p sitelen-core
cargo build -p sitelen-cli
cargo build -p sitelen-wasm
```

### Testing

```bash
# Run all tests
cargo test

# Run tests for specific crate
cargo test -p sitelen-core
```

### Running CLI

```bash
cargo run --bin sitelen -- "mi pona." --output output.svg
```

## Configuration

The renderer supports various configuration options:

- `optimal_ratio`: Preferred aspect ratio (default: 0.8)
- `stroke_width`: Stroke width for glyphs (default: 2.0)
- `shadow`: Enable shadow effects (default: false)
- `scale`: Base scale for glyphs (default: 1.2)
- `scale_skew`: Scale skew for container overflow (default: 1.3)

## Migration from JavaScript Version

The Rust version maintains the same visual output as the JavaScript version but with a different API:

### Old (JavaScript)

```html
<section data-sitelen data-sitelen-ratio="1">
    ale li jo e tenpo. ale li pona.
</section>
```

### New (Rust CLI)

```bash
sitelen "ale li jo e tenpo. ale li pona." --output output.svg --ratio 1.0
```

### New (WASM)

```javascript
import { render_svg } from './pkg/sitelen_wasm.js';
const svg = render_svg("ale li jo e tenpo. ale li pona.", null);
```

## Output Formats

- **SVG**: Scalable vector graphics (default)
- **PNG**: Rasterized image
- **HTML**: HTML page with embedded SVG

## Contributors

This live sitelen sitelen web project is made possible by the great work done before me.

**[Toki Pona](http://tokipona.org/)** is an artificial language invented in 2001 by Sonja Lang as an attempt to understand the meaning of life in 120 words. In my own search, I am convinced this language should not be used to translate large bodies of text or as an actual means of communication but as a personal tool for soul searching.

**[Sitelen Sitelen or Sitelen Suwi](http://www.jonathangabel.com/archive/2012/projects_t47.html)** is a project created by Jonathan Gabel in 2012 who created a non-linear writing style for Toki Pona inspired by Mayan script. I try to keep the algorithm behind the Sitelen Sitelen Renderer in the spirit of Jonathan's project and allow for the different ways of drawing the sitelen sitelen.

The **[vectorized glyphs](http://forums.tokipona.org/viewtopic.php?f=7&p=13786#p13786)** are based on the excellent work by jan Same. To make my SVGs scalable I sadly had to get rid of the non-uniform stroke widths. Also I have slightly different ideas about how to use the containers so I took the liberty of slightly altering some glyphs.

Mind that this project is far from complete: many language constructs are not implemented yet. If you want to contribute in any way, you can for instance file issues you find or come up with clever new ways to put sitelen sitelen into action.

Cheers!

## License

MIT (c) Olaf Janssen

## Author

Olaf T.A. Janssen <o.t.a.janssen@gmail.com>
